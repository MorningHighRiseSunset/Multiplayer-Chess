<html>
    <head>
        {{> head}}
    </head>
    <style>
        body {
            display: flex; /* Use flexbox for layout */
            justify-content: space-between; /* Space between elements */
            align-items: flex-start; /* Align items to the top */
            height: 100vh; /* Full height */
            margin: 0; /* Remove default margin */
        }

        .rectangle-box {
            position: fixed;
            top: 0;
            right: 0;
            width: 530px;
            height: 50px;
            background-color: #9e9e9e;
            border: 2px solid black;
            outline: none;
            text-align: center;
            line-height: 50px;
            color: white;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-evenly;
        }

        .pfp-icon {
            width: 50px;
            height: 50px;
            background-color: #cccccc;
            border-radius: 50%;
            margin: 0 5px;
            border: 2px solid black;
            position: relative;
        }

        .pfp-icon:before {
            content: "👤";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 28px;
        }

        #myBoard {
            width: 700px; /* Width of the chessboard */
            margin-right: 20px; /* Space between board and buttons */
        }

        #pgn-controls {
            display: flex; /* Use flexbox for button layout */
            flex-direction: column; /* Stack buttons vertically */
            align-items: flex-start; /* Align buttons to the left */
            margin-top: 10px; /* Space above the buttons */
        }

        .pgn-box {
            width: 200px;
            height: 150px;
            overflow-y: auto;
            background: black;
            color: white;
            padding: 5px;
            border: 1px solid red;
            margin-bottom: 10px; /* Space below the PGN box */
        }

        /* Additional styles for buttons */
        .yellowButton {
            background: -webkit-gradient(
                linear,
                left top,
                left bottom,
                color-stop(0.05, #ffec64),
                color-stop(1, #ffab23)
            );
            background: -moz-linear-gradient(top, #ffec64 5%, #ffab23 100%);
            background: -webkit-linear-gradient(top, #ffec64 5%, #ffab23 100%);
            background: -o-linear-gradient(top, #ffec64 5%, #ffab23 100%);
            background: -ms-linear-gradient(top, #ffec64 5%, #ffab23 100%);
            background: linear-gradient(to bottom, #ffec64 5%, #ffab23 100%);
            filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffec64', endColorstr='#ffab23', GradientType=0);
            background-color: #ffec64;
            border-radius: 6px;
            border: 1px solid #ffaa22;
            display: inline-block;
            cursor: pointer;
            color: #333333;
            font-family: Arial, sans-serif;
            font-size: 15px;
            font-weight: bold;
            padding: 6px 12px;
            text-decoration: none;
            text-shadow: 0px 1px 0px #ffee66;
            width: 80px;
            margin-bottom: 5px; /* Space between buttons */
        }

        .yellowButton:hover {
            background: -webkit-gradient(
                linear,
                left top,
                left bottom,
                color-stop(0.05, #ffab23),
                color-stop(1, #ffec64)
            );
            background: -moz-linear-gradient(top, #ffab23 5%, #ffec64 100%);
            background: -webkit-linear-gradient(top, #ffab23 5%, #ffec64 100%);
            background: -o-linear-gradient(top, #ffab23 5%, #ffec64 100%);
            background: -ms-linear-gradient(top, #ffab23 5%, #ffec64 100%);
            background: linear-gradient(to bottom, #ffab23 5%, #ffec64 100%);
            filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffab23', endColorstr='#ffec64', GradientType=0);
            background-color: #ffab23;
        }

        iframe {
            position: fixed;
            top: 55px; /* adjust this value to move the iframe up/down */
            right: 0px; /* adjust this value to move the iframe left/right */
        }
    </style>
    <body>
        <div class="rectangle-box">
            <div class="pfp-icon"></div>
            <div class="pfp-icon"></div>
            <div class="pfp-icon"></div>
            <div class="pfp-icon"></div>
            <div class="pfp-icon"></div>
        </div>
        <div id="myBoard"></div>
        <div id="pgn-controls">
            <label>Status:</label>
            <div id="status"></div>
            <label>PGN:</label>
            <div id="pgn" class="pgn-box"></div>

            <!-- Copy and Print Buttons -->
            <input
                type="button"
                class="yellowButton"
                id="copyMovesBtn"
                value="COPY"
            />
            <input
                type="button"
                class="yellowButton"
                id="printMovesBtn"
                value="PRINT"
            />
        </div>

        <script>
            let playerColor = "{{color}}";
            console.log("Playing as " + playerColor);

            // Example of setting PGN content dynamically
            function updatePGN(pgnContent) {
                document.getElementById("pgn").innerHTML = pgnContent;
            }

            // Copy Moves Functionality
            document.getElementById("copyMovesBtn").onclick = function () {
                const movesText = document.getElementById("pgn").innerText; // Get PGN content
                navigator.clipboard.writeText(movesText).then(
                    function () {
                        alert("Moves copied to clipboard!");
                    },
                    function (err) {
                        alert("Failed to copy moves: " + err);
                    },
                );
            };

            // Print Moves Functionality
            document.getElementById("printMovesBtn").onclick = function () {
                const movesText = document.getElementById("pgn").innerText; // Get PGN content
                const printWindow = window.open("", "", "height=400,width=600");
                printWindow.document.write(
                    "<html><head><title>Chess Moves</title></head><body>",
                );
                printWindow.document.write("<h1>Recorded Chess Moves</h1>");
                printWindow.document.write("<pre>" + movesText + "</pre>");
                printWindow.document.write("</body></html>");
                printWindow.document.close();
                printWindow.print();
            };
        </script>
        <script src="/public/js/index.js"></script>

        <iframe
            src="https://brie.fi/ng/stark-place-1?audio=1&video=1&fs=0&invite=0&prefs=0&share=0&chat=1"
            allow="camera; microphone; fullscreen; speaker; display-capture"
            style="width: 530px; height: 400px"
        >
            <p>Chat button</p>
        </iframe>
        <div id="instructions-popup" class="popup hide">
            <div class="popup-content">
                <span id="close-popup" class="close">&times;</span>
                <h2>Instructions</h2>
                <p>Follow these steps to play Chess:</p>
                <ol>
                    <li>
                        White moves first, followed by Black. Players alternate
                        turns.
                    </li>
                    <li>
                        Each type of piece moves in a specific way:
                        <ul>
                            <li>
                                <strong>Pawns</strong> move forward one square,
                                but capture diagonally. On their first move,
                                they can move forward two squares.
                            </li>
                            <li>
                                <strong>Rooks</strong> move horizontally or
                                vertically any number of squares.
                            </li>
                            <li>
                                <strong>Knights</strong> move in an "L" shape:
                                two squares in one direction and then one square
                                perpendicular.
                            </li>
                            <li>
                                <strong>Bishops</strong> move diagonally any
                                number of squares.
                            </li>
                            <li>
                                <strong>Queens</strong> move horizontally,
                                vertically, or diagonally any number of squares.
                            </li>
                            <li>
                                <strong>Kings</strong> move one square in any
                                direction.
                            </li>
                        </ul>
                    </li>
                    <li>
                        The objective is to checkmate your opponent's king by
                        placing it under threat of capture with no legal moves
                        to escape.
                    </li>
                    <li>
                        Special moves include castling, en passant, and pawn
                        promotion.
                    </li>
                    <li>
                        If a player's king is in check, they must make a move to
                        remove the threat.
                    </li>
                    <li>The game can end in checkmate or stalemate</li>
                </ol>
                <p>
                    In the video chat, there's a communication option available
                    to chat with your opponent (💬).
                </p>
                <p>Click Video icon (📷) to activate video chat</p>
                <p>To deactivate video chat, click (📷) again.</p>
                <p>
                    Please ensure camera & mic access is on in your site's
                    settings (⚙️)
                </p>
            </div>
        </div>
        <button id="instructions-button">Instructions</button>
        <button>
            <a
                href="https://masters-chess-game-09cdf1.netlify.app"
                target="_blank"
                >Play Against Computer</a
            >
        </button>
    </body>
</html>
